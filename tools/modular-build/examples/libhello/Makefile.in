# Copyright 2010 The Native Client Authors.  All rights reserved.
# Use of this source code is governed by a BSD-style license that can
# be found in the LICENSE file.

srcdir = @srcdir@
prefix = @prefix@

ifeq ($(shell uname),Darwin)
  shared_flag = -dynamiclib
  library_suffix = .dylib
else ifeq ($(shell uname -o),Cygwin)
  shared_flag = -shared
  library_suffix = .dll
else
  shared_flag = -shared
  library_suffix = .so
endif

all:

libhello$(library_suffix): $(srcdir)/libhello.c
	gcc $(shared_flag) -fPIC $< -o $@

install: libhello$(library_suffix)
	install -d $(DESTDIR)$(prefix)/lib
	install -d $(DESTDIR)$(prefix)/include
	install libhello$(library_suffix) $(DESTDIR)$(prefix)/lib
	install $(srcdir)/libhello.h $(DESTDIR)$(prefix)/include
