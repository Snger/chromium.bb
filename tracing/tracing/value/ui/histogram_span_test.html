<!DOCTYPE html>
<!--
Copyright (c) 2015 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="/tracing/value/diagnostics/diagnostic_map.html">
<link rel="import" href="/tracing/value/diagnostics/generic.html">
<link rel="import" href="/tracing/value/histogram.html">
<link rel="import" href="/tracing/value/ui/histogram_span.html">
<link rel="import" href="/tracing/value/unit.html">

<script>
'use strict';

tr.b.unittest.testSuite(function() {
  test('basic', function() {
    var h = new tr.v.Histogram(tr.v.Unit.byName.unitlessNumber);
    h.add(-1, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('a')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('b')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('b')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('b')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('b')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('b')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('b')}));
    h.add(0, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('c')}));
    h.add(500, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('c')}));
    h.add(999, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('d')}));
    h.add(1000, tr.v.d.DiagnosticMap.fromObject(
        {foo: new tr.v.d.Generic('d')}));

    var span = document.createElement('tr-v-ui-histogram-span');
    span.histogram = h;
    this.addHTMLOutput(span);
  });

  test('undefined', function() {
    var span = document.createElement('tr-v-ui-histogram-span');
    span.histogram = undefined;
    this.addHTMLOutput(span);
  });

  test('emptyHistogram', function() {
    var h = new tr.v.Histogram(tr.v.Unit.byName.unitlessNumber);

    var span = document.createElement('tr-v-ui-histogram-span');
    span.histogram = h;
    this.addHTMLOutput(span);
  });

  test('nans', function() {
    var h = new tr.v.Histogram(tr.v.Unit.byName.unitlessNumber);
    h.add(undefined, tr.v.d.DiagnosticMap.fromObject(
        {foo: new tr.v.d.Generic('b')}));
    h.add(NaN, tr.v.d.DiagnosticMap.fromObject({foo: new tr.v.d.Generic('c')}));
    h.customizeSummaryOptions({nans: true});

    var span = document.createElement('tr-v-ui-histogram-span');
    span.histogram = h;
    this.addHTMLOutput(span);
  });

});
</script>
