<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <!-- Copyright 2008 Google Inc.  All rights reserved. -->
  <head>
    <title>NPAPI Plug-in Test</title>
  </head>
  <body onload="nacllib.waitForModulesAndRunTests();"
          onunload="nacllib.cleanUp();" >
<script type="text/javascript" src="nacl_js_lib.js"></script>
<script type="text/javascript">
//<![CDATA[
var nacllib = new NaclLib(document.getElementsByName("nacl_module"),
                          document.getElementById("status"),
                          5);


nacllib.numModulesReady = function(modules) {
  var count = 0;
  for (var i = 0; i < modules.length; i++) {
    try {
      var foo = modules[i].fillRect();
      count += 1;
    } catch(e) {
      // do nothing
    }
  }
  return count;
};

var embed1 = null;
var embed2 = null;

nacllib.test = function() {
  // Enable control buttons
  document.getElementById('button_embed1_alert').disabled = null;
  document.getElementById('button_embed1_fillRect').disabled = null;
  document.getElementById('button_embed1_setProxy').disabled = null;
  document.getElementById('button_embed1_useProxy').disabled = null;
  document.getElementById('button_embed2_alert').disabled = null;
  document.getElementById('button_embed2_fillRect').disabled = null;
  document.getElementById('button_embed2_setProxy').disabled = null;
  document.getElementById('button_embed2_useProxy').disabled = null;
  // Color the first canvas.
  var canvas1 = document.getElementById("tutorial");
  var context1 = canvas1.getContext("2d");
  context1.fillStyle = "rgb(255, 255, 127)";
  context1.fillRect(0, 0, canvas1.width, canvas1.height);
  // Color the second canvas.
  var canvas2 = document.getElementById("tutorial2");
  var context2 = canvas2.getContext("2d");
  context2.fillStyle = "rgb(127, 255, 255)";
  context2.fillRect(0, 0, canvas2.width, canvas2.height);
  // Remember the objects for use by the buttons.
  embed1 = document.getElementById("embed1");
  embed2 = document.getElementById("embed2");
  // Return no errors.
  return "";
}
//]]>
</script>

  <h1>Native Client NPAPI Plug-in Test</h1>

  <!-- `embed` element test -->
  <embed id="embed1" src="npapi_test.nexe" type="application/x-nacl-srpc"
         name="nacl_module"
         width="0" height="0"
         canvas="tutorial"
         param1="with space"
         param2=""
         param3="with'quote"
         param4='with"doublequote' />
  <!-- `embed` element test -->
  <embed id="embed2" src="npapi_test.nexe" type="application/x-nacl-srpc"
         name="nacl_module"
         width=0 height=0
         canvas='tutorial2'
         param1="with space"
         param2=""
         param3="with'quote"
         param4='with"doublequote' />

  <br />

  <hr />
    <form name="formname">
      <input type=button value="proxy.fillRect()"
            onclick='proxy.fillRect()' />
      <hr />
      <input type=button value="alert(embed1.bar)" disabled="true"
            id='button_embed1_alert' onclick='alert(embed1.bar)' />
      <input type=button value="embed1.fillRect()" disabled="true"
            id='button_embed1_fillRect' onclick='embed1.fillRect()' />
      <input type=button value="embed1.setProxy()" disabled="true"
            id='button_embed1_setProxy' onclick='embed1.setProxy()' />
      <input type=button value="embed1.useProxy()" disabled="true"
            id='button_embed1_useProxy' onclick='embed1.useProxy()' />
      <hr />
      <input type=button value="alert(embed2.bar)" disabled="true"
            id='button_embed2_alert' onclick='alert(embed2.bar)' />
      <input type=button value="embed2.fillRect()" disabled="true"
            id='button_embed2_fillRect' onclick='embed2.fillRect()' />
      <input type=button value="embed2.setProxy()" disabled="true"
            id='button_embed2_setProxy' onclick='embed2.setProxy()' />
      <input type=button value="embed2.useProxy()" disabled="true"
            id='button_embed2_useProxy' onclick='embed2.useProxy()' />
    </form>
  <hr />

  <canvas id="tutorial" width="150" height="150"></canvas>
  <canvas id="tutorial2" width="150" height="150"></canvas>
  <p>
  <div id="status">NO-STATUS</div>

  </body>
</html>
