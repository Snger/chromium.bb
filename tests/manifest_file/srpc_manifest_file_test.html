<!DOCTYPE html>
<html>
  <head>
    <title>SRPC Manifest File Service</title>
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache" />
    <META HTTP-EQUIV="Expires" CONTENT="-1" />
    <script type="text/javascript" src="nacltest.js"></script>
    <script type="application/x-javascript">
      //<![CDATA[

function testMethods(tester, server) {
  tester.addTest('namedump', function() {
    assertEqual('nbytes = 47\n'
                +'KernelService\n'
                +'ManifestNameService\n'
                +'SecureRandom\n',
                server.namedump());
  })
  tester.addTest('manifest_test', function() {
    var str = server.manifest_test();
    assert(str.indexOf('Manifest Contents:\n') != -1,
           '"Manifest Contents" not found in "' + str + '"')
    assert(str.indexOf('nmf says hello world\n') != -1,
           '"nmf says hello world" not found in "' + str + '"')
  })
}

      //]]>
    </script>
  </head>
  <body>
    <h1>Native Client ManifestFile Service</h1>
    NOTE: Set NACL_ENABLE_EXPERIMENTAL_JAVASCRIPT_APIS=1 to run this test.

    <p>
      This test uses internal interfaces that should not be used by
      untrusted code.  Only the IRT code should use them, since these
      are not part of the stable ABI.  (The IRT implements the stable
      NaCl/Pepper interfaces.)
    </p>

    <embed type="application/x-nacl" id="nacl_server"
           name="nacl_module" width="0" height="0"
           src="srpc_manifest_file.nmf" />

    <script type="text/javascript">
      //<![CDATA[
      var tester = new Tester();
      var server = $("nacl_server");
      testMethods(tester, server);
      tester.waitFor(server);
      tester.run();
      //]]>
    </script>
  </body>
</html>
