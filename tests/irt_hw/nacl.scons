# -*- python -*-
# Copyright 2011 The Native Client Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can
# be found in the LICENSE file.

Import('env')

# Since the integrated runtime will be built with newlib,
# there's no need to build this module against glibc.
if env.Bit('nacl_glibc'):
  Return()

# Compile gc_instrumentation.c with -finstrument-for-thread-suspension
env.ComponentProgram('irt_hw.nexe',
                     ['irt_hw.c'],
                     EXTRA_LIBS=['irt'])
node = env.CommandSelLdrTestNacl(
  'irt_hw.out',
  command=[env.File('irt_hw.nexe')] )

env.AddNodeToTestSuite(node, ['small_tests'], 'run_irt_hw_test')
