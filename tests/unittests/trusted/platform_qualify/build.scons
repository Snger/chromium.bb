# -*- python -*-
# Copyright (c) 2011 The Native Client Authors.  All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.


Import('env')

# Set up the build environment: gtest does not compile with our strict settings.
env.FilterOut(CCFLAGS=['-pedantic'],
              CXXFLAGS=['-fno-rtti', '-Weffc++'])
env.Prepend(CPPPATH=['${SOURCE_ROOT}/testing/gtest/include'])

kernel_version_test_exe = env.ComponentProgram(
    'kernel_version_test',
    'kernel_version_test.cc',
    EXTRA_LIBS = [
        'gtest',
        'platform',
        'gio',
    ])

node = env.CommandTest(
    'kernel_version_test.out',
    command=[kernel_version_test_exe])
env.AddNodeToTestSuite(node, ['small_tests'], 'run_kernel_version_test')
