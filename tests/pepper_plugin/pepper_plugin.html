<html xmlns="http://www.w3.org/1999/xhtml">
<!--
Copyright (c) 2009 The Native Client Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->
<head>
<title> Pepper Plugin Demo </title>
</head>

<body style="background-image:url(nacl.png); background-repeat:repeat;"
      onload="nacllib.waitForModulesAndRunTests();"
      onunload="nacllib.cleanUp();">

This page embeds a NaCl module for testing Pepper.
</p>
<table>
<tr>
<td valign="top" width="50%">
  <embed name="nacl_module"
         id="plugin"
         name="nacl_module"
         type="application/x-nacl-srpc"
         src="pepper_plugin.nexe"
         width="400"
         height="400"
         dimensions="2" />
</td>
<td valign="top" style="background-color:Silver" width="50%">
<div id="event_text_box" style="width:400px; height:400px; overflow:auto">
</div>
</td>
</tr>
</table>
<p>
<div id="status">NO-STATUS</div>
<script type="text/javascript" src="nacl_js_lib.js"></script>
<script type="text/javascript">
//<![CDATA[
var nacllib = new NaclLib(document.getElementsByName("nacl_module"),
                          document.getElementById("status"),
                          1000);

// we use a custom detector for whether a module is ready or not
nacllib.numModulesReady = function(modules) {
  var count = 0;
  for (var i = 0; i < modules.length; i++) {
    try {
      var foo = modules[i].moduleReady();
      count += 1;
    } catch(e) {
      // do nothing
    }
  }
  return count;
};

// we use a custom detector for whether a module is ready or not
nacllib.areTherePluginProblems = function(modules) {
  return 0;
};

// The div where we report the events.
var event_box = null;

// The javascript function to add a line to the div.
var addLine = function(line) {
  event_box.innerHTML = line + '<br>' + event_box.innerHTML;
}

nacllib.test = function() {
  event_box = document.getElementById("event_text_box");;
  var plugin_obj = document.getElementById("plugin");
  // Add the banner to the top of the event log.
  addLine('<b>Event log</b>');
  // Set the plugin to report events to the event log.
  plugin_obj.setTextBox(addLine);
  // Return success.
  return "";
};
//]]>
</script>

</body>
</html>
